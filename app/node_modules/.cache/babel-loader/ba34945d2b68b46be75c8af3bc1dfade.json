{"ast":null,"code":"import _classCallCheck from\"C:\\\\gitrepos\\\\optimizer\\\\app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\gitrepos\\\\optimizer\\\\app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _assertThisInitialized from\"C:\\\\gitrepos\\\\optimizer\\\\app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";import _inherits from\"C:\\\\gitrepos\\\\optimizer\\\\app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"C:\\\\gitrepos\\\\optimizer\\\\app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import*as React from'react';import'../index.css';import httpClient from'../httpClient';import Spinner from'./Spinner';var config=require('../config.json');var Home=/*#__PURE__*/function(_React$Component){_inherits(Home,_React$Component);var _super=_createSuper(Home);function Home(props){var _this;_classCallCheck(this,Home);_this=_super.call(this,props);_this.state={isLoading:false,breaks:null,breaksWithCommercials:null,total:0,errors:false};_this.ensureDataFetched=_this.ensureDataFetched.bind(_assertThisInitialized(_this));_this.refetchData=_this.refetchData.bind(_assertThisInitialized(_this));_this.setLoading=_this.setLoading.bind(_assertThisInitialized(_this));return _this;}_createClass(Home,[{key:\"setLoading\",value:function setLoading(isLoading){this.setState({isLoading:isLoading});}},{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;this.ensureDataFetched().then(function(){_this2.refetchData();});}},{key:\"ensureDataFetched\",value:function ensureDataFetched(){var _this3=this;this.setLoading(true);var client=new httpClient();return client.get(\"\".concat(config.aws.api.url).concat(config.aws.api.path),{'x-api-key':config.aws.api.key}).then(function(response){if(response.data&&response.status===200){_this3.setState(function(state){return{state:state.breaks=response.data};});}_this3.setLoading(false);}).catch(function(err){_this3.setLoading(false);});}},{key:\"refetchData\",value:function refetchData(){var _this4=this;this.setLoading(true);var client=new httpClient();return client.post(\"\".concat(config.aws.api.url).concat(config.aws.api.path),this.state.breaks,{'x-api-key':config.aws.api.key}).then(function(response){if(response.data&&response.status===200){_this4.setState(function(state){return{state:state.breaksWithCommercials=response.data.breaksWithCommercials,total:response.data.total};});}_this4.setLoading(false);}).catch(function(err){_this4.setLoading(false);});}},{key:\"updateRating\",value:function updateRating(target,brId,demoName,elId){this.setState({current:elId});var value=target.value;var number=parseInt(value,10);if(value.length>6||isNaN(number)||!/^\\d+$/.test(value)){target.style.borderColor=\"red\";this.setState({errors:true});return;}else{this.setState({errors:false});target.style.borderColor=\"\";}var breaks=this.state.breaks;breaks.map(function(p){return p.Id===brId?p.Ratings.map(function(d){return d.DemoName===demoName?d.Score=number:d;}):p;});this.setState(function(state){return{state:state.breaks=breaks};});this.refetchData();}},{key:\"render\",value:function render(){var _this5=this;return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-2 refresh-cont\"},/*#__PURE__*/React.createElement(\"a\",{className:\"refresh d-inline d-md-none d-lg-none\",href:\"#\",onClick:function onClick(){return window.location.reload(false);}},\" Refresh\")),/*#__PURE__*/React.createElement(\"div\",{className:\"total col-10\"},this.state.isLoading?/*#__PURE__*/React.createElement(Spinner,{isLoading:this.state.isLoading}):this.state.total>0&&/*#__PURE__*/React.createElement(\"h2\",null,this.state.total))),/*#__PURE__*/React.createElement(\"div\",{className:\"main\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row row-header\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-2\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-12\"},\"Break\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-10\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-7 d-block d-sm-none d-md-none\"},\"Demo\"),/*#__PURE__*/React.createElement(\"div\",{className:\"col-7 d-none d-sm-block d-md-block\"},\"Demographic\"),/*#__PURE__*/React.createElement(\"div\",{className:\"col-5\"},\"Rating\")))),this.state.breaks&&this.state.breaks.map(function(br,i){return/*#__PURE__*/React.createElement(\"div\",{key:i,className:\"row align-items-center\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-2\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{key:i+1,className:\"col-12\"},br.Id))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-10\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},br.Ratings&&br.Ratings.map(function(rating,j){return/*#__PURE__*/React.createElement(React.Fragment,{key:j+5},/*#__PURE__*/React.createElement(\"div\",{key:j+1,className:\"col-7\"},/*#__PURE__*/React.createElement(\"span\",{key:j+2}),\"  \",rating.DemoName),/*#__PURE__*/React.createElement(\"div\",{key:j+3,className:\"col-5\"},/*#__PURE__*/React.createElement(\"input\",{key:\"\".concat(i).concat(j),type:\"number\",disabled:_this5.state.errors&&_this5.state.current!==\"\".concat(i).concat(j),inputMode:\"numeric\",onChange:function onChange(e){return _this5.updateRating(e.target,br.Id,rating.DemoName,\"\".concat(i).concat(j));},defaultValue:rating.Score})));}))));})),/*#__PURE__*/React.createElement(\"div\",{className:\"main lower\"},/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"row row-header\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-2\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-12 d-none d-sm-block d-md-block\"},\"Break\"),/*#__PURE__*/React.createElement(\"div\",{className:\"col-12 d-block d-sm-none d-md-none\"},\"Brk\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-10\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-4 d-none d-sm-block d-md-block\"},\"Commercial\"),/*#__PURE__*/React.createElement(\"div\",{className:\"col-4 d-none d-sm-block d-md-block\"},\"Demographic\"),/*#__PURE__*/React.createElement(\"div\",{className:\"col-4 d-block d-sm-none d-md-none\"},\"Comm\"),/*#__PURE__*/React.createElement(\"div\",{className:\"col-4 d-block d-sm-none d-md-none\"},\"Demo\"),/*#__PURE__*/React.createElement(\"div\",{className:\"col-4\"},\"Type\")))),this.state.breaksWithCommercials&&this.state.breaksWithCommercials.map(function(br,i){return/*#__PURE__*/React.createElement(\"div\",{key:i,className:\"row align-items-center\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-2\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{key:i+'a',className:\"col-12\"},br.Id))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-10\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},br.Commercials&&br.Commercials.map(function(comm,k){return/*#__PURE__*/React.createElement(React.Fragment,{key:k+'e'},/*#__PURE__*/React.createElement(\"div\",{key:k+'b',className:\"col-3 col-sm-4 col-md-4\"},_this5.state.isLoading?/*#__PURE__*/React.createElement(Spinner,{isLoading:_this5.state.isLoading}):comm.Id),/*#__PURE__*/React.createElement(\"div\",{key:k+'c',className:\"col-4 col-sm-4 col-md-4\"},_this5.state.isLoading?/*#__PURE__*/React.createElement(Spinner,{isLoading:_this5.state.isLoading}):comm.TargetDemoName),/*#__PURE__*/React.createElement(\"div\",{key:k+'d',className:\"col-5 col-sm-4 col-md-4\"},_this5.state.isLoading?/*#__PURE__*/React.createElement(Spinner,{isLoading:_this5.state.isLoading}):comm.CommercialTypeName));}))));}))));}}]);return Home;}(React.Component);;export default Home;","map":{"version":3,"sources":["C:/gitrepos/optimizer/app/src/components/Home.jsx"],"names":["React","httpClient","Spinner","config","require","Home","props","state","isLoading","breaks","breaksWithCommercials","total","errors","ensureDataFetched","bind","refetchData","setLoading","setState","then","client","get","aws","api","url","path","key","response","data","status","catch","err","post","target","brId","demoName","elId","current","value","number","parseInt","length","isNaN","test","style","borderColor","map","p","Id","Ratings","d","DemoName","Score","window","location","reload","br","i","rating","j","e","updateRating","Commercials","comm","k","TargetDemoName","CommercialTypeName","Component"],"mappings":"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","sourcesContent":["import * as React from 'react';\r\nimport '../index.css';\r\nimport httpClient from '../httpClient';\r\nimport Spinner from './Spinner';\r\nconst config = require('../config.json');\r\n\r\n\r\nclass Home extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            isLoading: false,\r\n            breaks: null,\r\n            breaksWithCommercials: null,\r\n            total: 0,\r\n            errors: false\r\n        }\r\n\r\n        this.ensureDataFetched = this.ensureDataFetched.bind(this);\r\n        this.refetchData = this.refetchData.bind(this);\r\n        this.setLoading = this.setLoading.bind(this);\r\n    }\r\n\r\n\r\n    setLoading(isLoading) {\r\n        this.setState({ isLoading });\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.ensureDataFetched()\r\n            .then(() => {\r\n                this.refetchData();\r\n            });\r\n    }\r\n\r\n    ensureDataFetched() {\r\n        this.setLoading(true);\r\n        const client = new httpClient();\r\n        return client.get(`${config.aws.api.url}${config.aws.api.path}`, { 'x-api-key': config.aws.api.key })\r\n            .then(response => {\r\n                if (response.data && response.status === 200) {\r\n                    this.setState((state) => {\r\n                        return { state: state.breaks = response.data };\r\n                    });\r\n                }\r\n                this.setLoading(false);\r\n            })\r\n            .catch((err) => { this.setLoading(false); });\r\n    }\r\n\r\n    refetchData() {\r\n        this.setLoading(true);\r\n        const client = new httpClient();\r\n        return client.post(`${config.aws.api.url}${config.aws.api.path}`, this.state.breaks, { 'x-api-key': config.aws.api.key })\r\n            .then(response => {\r\n                if (response.data && response.status === 200) {\r\n                    this.setState((state) => {\r\n                        return { state: state.breaksWithCommercials = response.data.breaksWithCommercials, total: response.data.total };\r\n                    });\r\n                }\r\n                this.setLoading(false);\r\n            })\r\n            .catch((err) => { this.setLoading(false); });\r\n    }\r\n\r\n    updateRating(target, brId, demoName, elId) {\r\n        this.setState({ current: elId });\r\n        let value = target.value;\r\n        const number = parseInt(value, 10);\r\n        if (value.length > 6 || isNaN(number) || ! /^\\d+$/.test(value)) {\r\n            target.style.borderColor = \"red\";\r\n            this.setState({ errors: true });\r\n            return;\r\n        }\r\n        else {\r\n            this.setState({ errors: false });\r\n            target.style.borderColor = \"\";\r\n        }\r\n\r\n        const breaks = this.state.breaks;\r\n        breaks.map(p => p.Id === brId ? p.Ratings.map(d => d.DemoName === demoName ? d.Score = number : d) : p);\r\n        this.setState((state) => {\r\n            return { state: state.breaks = breaks };\r\n        });\r\n        this.refetchData();\r\n    }\r\n\r\n\r\n    render() {\r\n        return (\r\n            <React.Fragment>\r\n                <div className=\"row\">\r\n                    <div className=\"col-2 refresh-cont\">\r\n                        <a className=\"refresh d-inline d-md-none d-lg-none\" href=\"#\" onClick={() => window.location.reload(false)}> Refresh</a>\r\n                    </div>\r\n                    <div className=\"total col-10\">\r\n                        {this.state.isLoading ? <Spinner isLoading={this.state.isLoading} /> :\r\n                            this.state.total > 0 && <h2>{this.state.total}</h2>\r\n                        }\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"main\">\r\n                    <div className=\"row row-header\">\r\n                        <div className=\"col-2\">\r\n                            <div className=\"row\">\r\n                                <div className=\"col-12\">Break</div>\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"col-10\">\r\n                            <div className=\"row\">\r\n                                <div className=\"col-7 d-block d-sm-none d-md-none\">Demo</div>\r\n                                <div className=\"col-7 d-none d-sm-block d-md-block\">Demographic</div>\r\n                                <div className=\"col-5\">Rating</div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    {this.state.breaks && this.state.breaks.map((br, i) =>\r\n                        <div key={i} className=\"row align-items-center\">\r\n                            <div className=\"col-2\">\r\n                                <div className=\"row\">\r\n                                    <div key={i + 1} className=\"col-12\" >{br.Id}</div>\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"col-10\">\r\n                                <div className=\"row\">\r\n                                    {br.Ratings && br.Ratings.map((rating, j) =>\r\n                                        <React.Fragment key={j + 5}>\r\n                                            <div key={j + 1} className=\"col-7\">\r\n                                                <span key={j + 2}></span>  {rating.DemoName}\r\n                                            </div>\r\n\r\n                                            <div key={j + 3} className=\"col-5\">\r\n                                                <input key={`${i}${j}`} type=\"number\" disabled={this.state.errors && this.state.current !== `${i}${j}`} inputMode=\"numeric\" onChange={(e) => this.updateRating(e.target, br.Id, rating.DemoName, `${i}${j}`)} defaultValue={rating.Score} />\r\n                                            </div>\r\n                                        </React.Fragment>\r\n                                    )}\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n                <div className=\"main lower\">\r\n                    <React.Fragment>\r\n                        <div className=\"row row-header\">\r\n                            <div className=\"col-2\">\r\n                                <div className=\"row\">\r\n                                    <div className=\"col-12 d-none d-sm-block d-md-block\">Break</div>\r\n                                    <div className=\"col-12 d-block d-sm-none d-md-none\">Brk</div>\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"col-10\">\r\n                                <div className=\"row\">\r\n                                    <div className=\"col-4 d-none d-sm-block d-md-block\">Commercial</div>\r\n                                    <div className=\"col-4 d-none d-sm-block d-md-block\">Demographic</div>\r\n                                    <div className=\"col-4 d-block d-sm-none d-md-none\">Comm</div>\r\n                                    <div className=\"col-4 d-block d-sm-none d-md-none\">Demo</div>\r\n                                    <div className=\"col-4\">Type</div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        {this.state.breaksWithCommercials && this.state.breaksWithCommercials.map((br, i) =>\r\n                            <div key={i} className=\"row align-items-center\">\r\n                                <div className=\"col-2\">\r\n                                    <div className=\"row\">\r\n                                        <div key={i + 'a'} className=\"col-12\" >{br.Id}</div>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"col-10\">\r\n                                    <div className=\"row\">\r\n                                        {br.Commercials && br.Commercials.map((comm, k) =>\r\n                                            <React.Fragment key={k + 'e'}>\r\n                                                <div key={k + 'b'} className=\"col-3 col-sm-4 col-md-4\">\r\n                                                    {this.state.isLoading ? <Spinner isLoading={this.state.isLoading} /> :\r\n                                                        comm.Id\r\n                                                    }\r\n                                                </div>\r\n                                                <div key={k + 'c'} className=\"col-4 col-sm-4 col-md-4\">\r\n                                                    {this.state.isLoading ? <Spinner isLoading={this.state.isLoading} /> :\r\n                                                        comm.TargetDemoName\r\n                                                    }\r\n                                                </div>\r\n                                                <div key={k + 'd'} className=\"col-5 col-sm-4 col-md-4\">\r\n                                                    {this.state.isLoading ? <Spinner isLoading={this.state.isLoading} /> :\r\n                                                        comm.CommercialTypeName\r\n                                                    }\r\n                                                </div>\r\n                                            </React.Fragment>\r\n                                        )}\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n                    </React.Fragment>\r\n                </div>\r\n            </React.Fragment>\r\n        )\r\n    };\r\n};\r\nexport default Home;"]},"metadata":{},"sourceType":"module"}